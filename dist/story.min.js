String.prototype.has=function(a){return-1!=this.indexOf(a)};String.prototype.isNumber=function(){return!isNaN(this)};String.prototype.toNumber=function(){return+this};
var Utils=new Class({defaultFor:function(a,b){return"undefined"!=typeof a?a:b},randomString:function(a){a=this.defaultFor(a,5);for(var b="",f=0;a>f;f++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(this.randomInt(62));return b},randomInt:function(a){return Math.floor(Math.random()*this.defaultFor(a,2))}}),Class=function(){function a(a,e){for(var c in e)if("extend"!==c&&"static"!==c&&"typeOf"!==c&&"mixin"!==c){if("object"==typeof e[c]||"function"==typeof e[c])return void(a[c]=
e[c]);c===c.toUpperCase()?(Object.defineProperty(a,c,{writable:!1,configurable:!1,enumerable:!0,value:e[c]}),Object.defineProperty(a.prototype,c,{writable:!1,configurable:!1,enumerable:!0,value:e[c]})):(Object.defineProperty(a,c,{get:function(){return e[c]},set:function(a){e[c]=a}}),Object.defineProperty(a.prototype,c,{get:function(){return e[c]},set:function(a){e[c]=a}}))}}function b(a,e,c){c=c||!1;for(var b in e)"create"===b&&!c||"typeOf"===b||"mixin"===b||"static"===b||"extend"===b||(a[b]=e[b])}
return function(f){var e=!1;return function n(f,d){var k,l=[],h=d.hasOwnProperty("singleton")&&d.singleton,g=function(){if("function"==typeof this.create&&!1===e&&this.create.apply(this,arguments),d.hasOwnProperty("get"))for(var a in d.get){var b="set"in d&&a in d.set?d.set[a]:null;null!==b?(delete d.set[a],Object.defineProperty(this,a,{get:d.get[a],set:b})):Object.defineProperty(this,a,{get:d.get[a]})}if(d.hasOwnProperty("set"))for(a in d.set)Object.defineProperty(this,a,{set:d.set[a]});if(h&&"undefined"!=
typeof this)throw Error("Singleton object cannot have more than one instance, call instance method instead");};null!==f&&(e=!0,g.prototype=new f,e=!1);var m=g.prototype;return m.typeOf=function(a){return"object"==typeof a?0<=l.indexOf(a):"function"==typeof a&&(this instanceof a||0<=l.indexOf(a))?!0:!1},"function"==typeof d&&(d=d()),b(m,d,!0),g["static"]=function(b){return a(g,b),g},g.mixin=function(){for(var a=0,e=arguments.length;e>a;a++){var d=arguments[a];if("function"==typeof d)var f=d.prototype;
else{if("object"!=typeof d)throw Error("js.class mixin method accepts only types: object, function - `"+typeof d+"` type given");f=d}b(m,f,!1);l.push(d)}return g},h?(g.extend=function(){throw Error("Singleton class cannot be extended");},g.instance=function(){return k||(h=!1,k=new g,h=!0),k}):g.extend=function(a){return n(this,a)},g}(null,f)}}(),Cookie=new Class({data:{},create:function(){0!==document.cookie.length&&this.read()},read:function(){this.data={};try{for(var a=document.cookie.split("|"),
b=0;b<a.length;b++){var f=a[b].split(":");f[1].isNumber()&&(f[1]=f[1].toNumber());this.data[f[0]]=f[1]}}catch(e){console.log("Error reading the cookie with error: ",e.message)}},save:function(){document.cookie="";for(var a in this.data)this.data.hasOwnProperty(a)&&(document.cookie+=a+":"+this.data[a]+"|");document.cookie=document.cookie.slice(0,-1)},add:function(a,b){if("undefined"===this.data[a])throw"Key already exists";this.data[a]=b},remove:function(a){try{delete this.data[a]}catch(b){throw"No such key";
}},change:function(a,b){if("undefined"===this.data[a])throw"No such key";this.data[a]=b}}),cookie=new Cookie,utils=new Utils,Story=new Class({create:function(){0===cookie.data.length&&this.login()},login:function(){var a=prompt("Enter your Story Id to pick up where you left off or cancel to create a new game");null!==a&&""!==a||cookie.add("story_id",1E3*Math.random())},save:function(){this._getCurrentPageName()},_getCurrentPageName:function(){var a=window.location.pathname.split("/");return 1==a.length?
"index":a.pop().split(".")[0]}});
